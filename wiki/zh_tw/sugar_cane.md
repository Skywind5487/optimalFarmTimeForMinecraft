# Minecraft 甘蔗產率分析

## 先說結果

最佳採收時間為: 41 分 2 秒 13 刻（49253 ticks）
每個甘蔗點位每小時產量(產率)為: 2.6 個甘蔗

## 問題背景與數學推導

請先閱讀[tick_and_chunk](tick_and_chunk.md)

### 甘蔗生長機制

在 Minecraft 中，甘蔗的生長具有以下特點：

1. 每個甘蔗有機會在每 tick 嘗試生長，但僅有頂端的甘蔗才能生長
2. 單個甘蔗最高可生長至三格高
3. 根據高度，收穫時能獲得不同數量的甘蔗：
   - 1格高：不收穫（保留）
   - 2格高：收穫1個
   - 3格高：收穫2個

### 數學模型建立

在頂端收到 random tick 跟在底部收到的機率相同，因此問題改成底部收到幾次。

#### 基礎機率計算

隨機tick選中機率：$\frac{3}{16^3}$ (3個隨機tick / 子區塊體積)，稱為一次成功。

因此總機率為：

```python
p = 3 / (16³)
```

#### 二項分布模型

由於每次發生的機率相同、獨立、只有發生與不發生兩種選擇，因此符合二項分布。具體實作中：

1. 定義不同高度的機率：
    - P0：保持1格高的機率（0-15次成功）
        - 收穫 = 0
    - P1：達到2格高的機率（16-31次成功）
        - 收穫 = 1
    - P2：達到3格高的機率（32次以上成功）
        - 收穫 = 2

2. 計算期望產量：
   ```python
   期望產量 = P1 * 1 + P2 * 2
   ```

3. 產率計算：
   ```python
   產率 = 期望產量 / 時間
   ```

#### 泊松分布模型

當 x 很大且 p 很小時，二項分布可以用泊松分布近似。在這種情況下：

1. λ = xp（期望成功次數）
2. 使用相同的邏輯計算P0、P1、P2
3. 計算方式與二項分布相同

## 數值分析結果

### Python程式實作結果

程式使用數值方法找到了最佳產率時間點：

- 二項分布模型：
  - 最大產率：0.000036 甘蔗/tick
  - 最佳時間：41 分 2 秒 13 刻（49253 ticks）
- 泊松分布模型：
  - 最大產率：0.000036 甘蔗/tick
  - 最佳時間：41 分 2 秒 13 刻（49253 ticks）

轉換為每小時產率：

```
0.000036 * 20 * 60 * 60 ≈ 2.6 甘蔗/小時
```

## 程式實作細節

### 核心參數設定

```python
p = 3 / (16 ** 3)  # 每 tick 成功生長的機率
max_ticks = 10**5   # 最大考慮時間範圍
```

### 優化

1. 使用 NumPy 的向量化操作提高計算效率
2. 採用 linspace 減少計算點數
3. 利用 SciPy 的高效統計函數
4. 使用minimize_scalar進行精確的極值搜索

## 問題
我們以x次為一個輪迴，然後假設他每一次都會從頭開始計算，這在紫水晶可以但甘蔗不行。
因為我們並不會把甘蔗的底部方塊打掉，也就是可能留存上一次的紀錄。這樣算出來就不對。

## 結論

1. 二項分布和泊松分布給出完全相同的結果
2. 最佳等待時間約為 41 分鐘（49253 ticks）
3. 在最佳時間點，每個甘蔗點位的理論最大產率約為 2.6 個/小時
4. 相較於紫水晶，甘蔗的生長速度快得多（紫水晶約為 0.517 個/小時）

## 上一篇

previous: [amethyst](amethyst.md)

## 參考資料

- [Sugar Cane – Minecraft Wiki](https://minecraft.wiki/w/Sugar_Cane)
- [Tick – Minecraft Wiki](https://minecraft.wiki/w/Tick#Random_tick)